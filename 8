import java.math.BigInteger;
import java.security.SecureRandom;

public class dsaAlg {

    static SecureRandom r = new SecureRandom();

    public static void main(String[] args) {

        BigInteger q = new BigInteger("127");
        BigInteger p = new BigInteger("1193"); 
        BigInteger g = new BigInteger("596");

        BigInteger x = new BigInteger("77");
        BigInteger y = g.modPow(x, p);

        BigInteger k;
        do {
            k = new BigInteger("113");
        } while (k.mod(q).equals(BigInteger.ZERO));

        BigInteger rVal = g.modPow(k, p).mod(q);

        BigInteger hash = new BigInteger("88");

        BigInteger s = k.modInverse(q)
                .multiply(hash.add(x.multiply(rVal)))
                .mod(q);

        System.out.println("p: " + p);
        System.out.println("q: " + q);
        System.out.println("g: " + g);
        System.out.println("x: " + x);
        System.out.println("y: " + y);
        System.out.println("r: " + rVal);
        System.out.println("s: " + s);

        BigInteger w = s.modInverse(q);
        BigInteger u1 = hash.multiply(w).mod(q);
        BigInteger u2 = rVal.multiply(w).mod(q);

        BigInteger v = g.modPow(u1, p)
                .multiply(y.modPow(u2, p))
                .mod(p)
                .mod(q);

        System.out.println("v: " + v);

        if (v.equals(rVal))
            System.out.println("Signature Verified");
        else
            System.out.println("Signature Invalid");
    }
}
